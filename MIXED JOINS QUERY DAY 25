-- Q1 WAQTD ENAME , AND LOC FOR ALL THE EMP
SELECT E.ENAME,D.LOC
FROM SCOTT.EMP E INNER JOIN SCOTT.DEPT D
ON E.DEPTNO = D.DEPTNO;

-- Q2 WAQTD NAME ,SAL,DNAME IF SAL>2000
SELECT ENAME,SAL,DNAME
FROM SCOTT.EMP E INNER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO
WHERE SAL>2000;
-- Q3 NAME , DNO ,LOC OF EMP,IF DEPTNO=20;
SELECT ENAME,E.DEPTNO,LOC
FROM SCOTT.EMP E INNER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO
WHERE E.DEPTNO=20;
-- Q4 
SELECT E.ENAME,E.HIREDATE,E.DEPTNO,E.SAL,D.LOC,E.SAL*6 AS HALFTERM , DNAME,JOB
FROM SCOTT.EMP E INNER JOIN SCOTT.DEPT D 
ON E.DEPTNO=D.DEPTNO
WHERE HIREDATE LIKE '%81' AND E.DEPTNO IN(20,30) AND JOB!='SALESMAN' AND D.LOC IN('CHICAGO') AND DNAME='RESEARCH';

-- Q5 
SELECT ENAME , HIREDATE
FROM SCOTT.EMP
WHERE HIREDATE >(SELECT HIREDATE 
                 FROM SCOTT.EMP
                 WHERE ENAME='BLAKE');

-- Q6 
SELECT E.ENAME,D.LOC
FROM SCOTT.EMP E INNER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO
WHERE E.SAL IN(SELECT MAX(SAL)
             FROM SCOTT.EMP
             WHERE SAL<(SELECT MAX(SAL)
                        FROM SCOTT.EMP));                 
-- Q7 
SELECT COUNT(*),D.LOC
FROM SCOTT.EMP E INNER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO
WHERE  SAL <(SELECT SAL
             FROM SCOTT.EMP
             WHERE EMPNO=(SELECT MGR
                          FROM SCOTT.EMP
                          WHERE ENAME='CLARK'))
GROUP BY LOC
HAVING COUNT(*)>=2
ORDER BY LOC DESC;        

-- OUTER JOIIN 
-- Q8
SELECT DNAME,ENAME
FROM SCOTT.DEPT D LEFT OUTER JOIN SCOTT.EMP E
ON E.DEPTNO=D.DEPTNO;

-- Q9 
SELECT ENAME,DNAME
FROM SCOTT.EMP E LEFT OUTER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO;

-- Q10
SELECT E.ENAME AS ENAME, M.ENAME AS MNAME ,E.SAL AS ESAL ,M.SAL AS MSAL
FROM SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO
WHERE E.SAL=M.SAL;

-- Q11 
SELECT E.ENAME AS ENAMES , M.ENAME AS MNAME , E.SAL AS ESAL,M.SAL AS MSAL
FROM SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=E.EMPNO
WHERE M.JOB='MANAGER';

-- Q12 
SELECT MAX(E.SAL),MAX(M.SAL),E.JOB,M.JOB
FROM SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO
GROUP BY E.JOB,M.JOB 

-- Q13
SELECT E.ENAME AS ENAMIE ,M.ENAME AS MNAME ,LOC
FROM (SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO)INNER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO
WHERE D.LOC='NEW YORK';

-- Q14 

SELECT E.ENAME AS ENAMES,M.ENAME AS MNAME,E.SAL AS ESAL , M.SAL AS MSAL,D1.LOC,D.DNAME
FROM ((SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO)INNER JOIN SCOTT.DEPT D
ON E.DEPTNO=D.DEPTNO)INNER JOIN SCOTT.DEPT D1
ON D1.DEPTNO=E.DEPTNO

-- Q15 
SELECT E.ENAME AS ENAME,M.ENAME AS MNAME,D.DNAME
FROM (SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO)LEFT JOIN SCOTT.DEPT D
ON M.DEPTNO=D.DEPTNO;

-- Q16 
SELECT E.ENAME AS ENAMES,M.ENAME AS MNAMES,M1.ENAME AS "MGR'S MGRNAME"
FROM (SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO ) JOIN SCOTT.EMP M1
ON M.MGR=M1.EMPNO 






