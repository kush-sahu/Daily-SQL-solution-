-- Q1 WAQTD to display details of the employ if the deptno of that emp having max sal =3000 
select *
from scott.emp
where deptno in(
        select deptno
        from scott.emp
        group by deptno
        having max(sal)=3000);

-- Q2 WAQTD DETAILS OF THE EMPLOYEE FROM THE DESIGNATION WHERE EXACTLY 4 EMP ARE WORKING, SORTED BY NAME IN DESC
     
SELECT *
FROM SCOTT.EMP
WHERE JOB IN(SELECT JOB 
              FROM SCOTT.EMP
              GROUP BY JOB
              HAVING COUNT(*)=4)
ORDER BY ENAME DESC;   

-- Q3  WAQTD DETAILS OF AN EMP EARNING LESS THAN 'KING' 
SELECT *
FROM SCOTT.EMP
WHERE SAL <(SELECT SAL 
             FROM SCOTT.EMP
             WHERE ENAME='KING');


--- Q4 WAQTD DETAILS OF EMP’S WHO ARE WORKING IN SAME DESIGNATION AS THAT OF ‘FORD’

SELECT *
FROM SCOTT.EMP
WHERE JOB IN (SELECT JOB
              FROM SCOTT.EMP
              WHERE ENAME='FORD');

--- Q5 WAQTD DETAILS OF EMP’S WHO ARE WORKING IN SAME DEPT AS THAT OF KING
SELECT *
FROM SCOTT.EMP
WHERE DEPTNO IN(SELECT DEPTNO
                FROM SCOTT.EMP
                WHERE ENAME='KING')

--- Q6 WAQTD DETAILS OF EMP’S HIRED AFTER ‘WARD’
SELECT *
FROM SCOTT.EMP
WHERE HIREDATE>(
SELECT HIREDATE
FROM SCOTT.EMP
WHERE ENAME='WARD');

--- Q7 WAQTD NAMES OF AN EMP WORKING AS SALESMAN & EARNING LESS THAN MARTIN.
SELECT *
FROM SCOTT.EMP
WHERE ENAME = 'SALESMAN' AND SAL<(SELECT SAL
                                  FROM SCOTT.EMP
                                  WHERE ENAME='MARTIN');

--- Q8 WAQTD DETAILS OF EMP’S WHO ARE EARNING MORE THAN ‘JAMES’ & LESS THAN ‘JONES’
SELECT *
FROM SCOTT.EMP
WHERE SAL>(SELECT SAL
           FROM SCOTT.EMP
           WHERE ENAME='JAMES')AND 
     SAL<(SELECT SAL
           FROM SCOTT.EMP
           WHERE ENAME='JONES');

 -- Q9  WAQTD NAMES OF EMP & SAL OF THE EMPS EARNING LESS THAN KING. 
SELECT ENAME,SAL
FROM SCOTT.EMP
WHERE SAL<(SELECT SAL
           FROM SCOTT.EMP
           WHERE ENAME='KING');
--- Q10 WAQTD NAMES OF EMP & SAL OF THE EMPS EARNING LESS THAN ADAMS 
SELECT ENAME,SAL
FROM SCOTT.EMP
WHERE SAL<(SELECT SAL
           FROM SCOTT.EMP
           WHERE ENAME='ADAMS');

--- Q11  WAQTD NAME & DEPTNO OF THE EMP IF THEY ARE WORKING IN THE SAME DEPT AS JONES.           
SELECT ENAME,deptno
FROM SCOTT.EMP
WHERE DEPTNO IN(SELECT DEPTNO 
                FROM SCOTT.EMP
                WHERE ENAME='JONES');

-- Q12 WAQTD NAME & JOB OF ALL THE EMP’S WORKING IN THE SAME   DESIGNATION AS JAMES.             
SELECT ENAME,JOB
FROM SCOTT.EMP
WHERE JOB IN(SELECT JOB
             FROM SCOTT.EMP
             WHERE ENAME='JAMES');

-- Q13 WAQTD EMPNO & ENAME ALONG WITH ANNUAL SAL OF ALL THE EMPS IF THEIR ANNUAL SAL IS GREATER THAN ‘WARD’ ANNUAL SAL.           
SELECT EMPNO,ENAME,(SAL*12) AS ANUAL
FROM SCOTT.EMP
WHERE SAL*12>(SELECT SAL*12
              FROM SCOTT.EMP
              WHERE ENAME='WARD');

-- Q14 WAQTD NAME & HIREDATE OF EMP’S IF THEY HIRED BEFORE TURNER. 
SELECT ENAME , HIREDATE
FROM SCOTT.EMP
WHERE HIREDATE <(SELECT HIREDATE 
                 FROM SCOTT.EMP
                 WHERE ENAME='TURNER');


-- Q15 WAQTD NAME & HIREDATE OF EMP’S IF THEY ARE HIRED AFTER PRESIDENT.     
SELECT ENAME , HIREDATE
FROM SCOTT.EMP
WHERE HIREDATE >(SELECT HIREDATE 
                 FROM SCOTT.EMP
                 WHERE job='PRESIDENT');
                 

-- Q16 WAQTD NAME & SAL OF EMPS IF THEY ARE EARNING SAL LESS THAN THE EMP WHOSE EMPNO IS 7839.
SELECT ENAME,SAL
FROM SCOTT.EMP
WHERE SAL<(SELECT SAL 
           FROM SCOTT.EMP
           WHERE EMPNO=7839 );

-- Q17 WAQTD DETAILS OF EMP IF EMP IS HIRED BEFORE MILLER.
SELECT *
FROM SCOTT.EMP
WHERE HIREDATE<(SELECT HIREDATE 
                FROM SCOTT.EMP
                WHERE ENAME='MILLER');
-- Q18 WAQTD DETAILS OF EMP WHO EARNS MORE THAN ALLEN. 
SELECT *
FROM SCOTT.EMP
WHERE SAL>(SELECT SAL
FROM SCOTT.EMP
WHERE ENAME='ALLEN') ;   

-- Q19 WAQTD NUMBER OF EMP’S HIRED AFTER KING. 
SELECT COUNT(*)
FROM SCOTT.EMP
WHERE HIREDATE>(SELECT HIREDATE
                 FROM SCOTT.EMP
                 WHERE ENAME='KING');
 -- Q20  WAQTD TOTAL SAL GIVEN TO EMP’S WORKING IN SAME DEPT AS THAT OF ‘WARD’               
SELECT SUM(SAL)
FROM SCOTT.EMP
WHERE DEPTNO IN(SELECT deptno
                FROM SCOTT.EMP
                WHERE ENAME='WARD');

-- Q21 WAQTD DETAILS OF EMP WORKING IN DEPT NO 20 & WORKING IN SAME DESIGNATION AS THAT OF SMITH. 
SELECT *
FROM SCOTT.EMP
WHERE DEPTNO IN(20) AND JOB IN(SELECT JOB
                               FROM SCOTT.EMP
                               WHERE ENAME='SMITH');
 -- Q22  WAQTD ENAME & SAL OF EMP’S WHO ARE EARNING MORE THAN MILLER BUT LESS THAN ALLEN                             
 SELECT ENAME,SAL
 FROM SCOTT.EMP
 WHERE SAL>(SELECT SAL
            FROM SCOTT.EMP
            WHERE ENAME='MILLER')AND SAL<(SELECT SAL
            FROM SCOTT.EMP
            WHERE ENAME='ALLEN')

-- Q23 WAQTD ENAME & SAL OF ALL THE EMPS WHO ARE EARNING MORE THAN 1000 BUT LESS THAN 3000
SELECT ENAME,SAL
FROM SCOTT.EMP
WHERE SAL>1000 AND SAL<3000;

-- Q24 WAQTD ALL THE DETAILS OF EMP WORKING IN DEPT NO 20 & WORKING IN SAME DESIGNATION AS SMITH. 
SELECT *
FROM SCOTT.EMP
WHERE DEPTNO IN(20) AND JOB IN(SELECT JOB FROM SCOTT.EMP WHERE ENAME='SMITH');

--Q25 WAQTD DETAILS OF EMP WORKING AS MANAGER IN THE SAME DEPT AS TURNER. 
SELECT *
FROM SCOTT.EMP
WHERE JOB='MANAGER' AND DEPTNO IN(SELECT DEPTNO FROM SCOTT.EMP WHERE ENAME='TURNER');

--Q26  WAQTD NAME & HIREDATE OF EMP’S HIRED AFTER 1980 & BEFORE KING. 
SELECT ENAME,HIREDATE
FROM SCOTT.EMP
WHERE HIREDATE >'31-DEC-80' AND HIREDATE<(SELECT HIREDATE
                                          FROM SCOTT.EMP
                                          WHERE ENAME='KING');
-- Q27 WAQTD NAME & SAL ALONG WITH ANNUAL SAL FOR ALL EMP’S WHOSE SAL IS LESS THAN BLAKE OR EMP’S EARNING MORE THAN 3500. 
SELECT ENAME,SAL,(SAL*12)AS ANNUAL_SAL
FROM SCOTT.EMP
WHERE SAL<(SELECT SAL
           from SCOTT.EMP
           WHERE ENAME='BLAKE')or SAL>3500;

           