-- Pseudo Column ROW NUM
select  *
from(select rownum as r, scott.emp.*
      from scott.emp)t
where t.r=2;


-- Q1 WAQTD emp name , mgr name, emp sal,mgr sal, if the emp sal and mgr sal is same
select e.ENAME as Emp_name, m.ENAME as MGR_Name, e.sal as E_sal,m.sal as M_sal
from scott.emp e 
join scott.emp m on e.mgr=m.empno;

-- Q2 WAQTD EMP NAME, MGR NAME,EMP SAL, MGR SAL, IF THE MGR IS WORKING AS ACTUAL MANAGER
SELECT E.ENAME AS EMPNAME,M.ENAME AS MNAME,E.SAL AS ESAL,M.SAL AS MSAL
FROM SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.empno
WHERE M.JOB='MANAGER';

-- Q3 WAQTD HIGHEST EMP SAL AND HIGHEST MGR SAL IN EACH EMP JOB AND MGR JOB 
SELECT MAX(E.SAL) AS ESAL ,MAX(M.SAL) AS MSAL
FROM SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO;

-- Q4 WAQTD EMP NAME, MGR NAME , MGR DNAME
SELECT E.ENAME AS EMPNAME , M.ENAME AS MGRNAME ,D.DNAME AS DEPT
FROM (SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO) INNER JOIN SCOTT.DEPT D
ON M.DEPTNO=D.DEPTNO;


-- Q5 WAQTD ENAME, MGR NAME , EMP LOC IF THE EMP ARE WORKING IN NEW YORK
SELECT E.ENAME AS ENAME,M.ENAME AS MNAME,D.LOC
FROM (SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO )INNER JOIN SCOTT.DEPT D
ON D.DEPTNO=E.DEPTNO
WHERE D.LOC='NEW YORK';


-- Q6 WAQTD ENAME,ESAL ,MGR SAL , MGR NAME , EMP LOC AND MGR DNAME
SELECT E.ENAME AS EMP_NAME,M.ENAME AS MGR_NAME,E.SAL AS ESAL,M.SAL AS MSAL,DE.LOC AS LOC,DM.DNAME
FROM ((SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO)INNER JOIN SCOTT.DEPT DE
ON E.DEPTNO =DE.DEPTNO )INNER JOIN SCOTT.DEPT DM
ON M.DEPTNO=DM.DEPTNO;


-- Q7 WAQTD ENAME, MNAME ,MDNAME CHECK IF ALL THE MGRS ARE WORKING IN DEPT OR NOT 
SELECT E.ENAME AS EMP_NAME,M.ENAME AS MGR_NAME,DM.DNAME
FROM ((SCOTT.EMP E JOIN SCOTT.EMP M
ON E.MGR=M.EMPNO)LEFT OUTER JOIN SCOTT.DEPT DM
ON DM.DEPTNO=M.DEPTNO)

-- Q8 WAQTD ENAME , MNAME, MGR'S MANAGER NAME
SELECT E.ENAME AS EMP_NAME,M.ENAME AS MGR_NAME,MM.ENAME AS "MGR'S MGR_NAME"
FROM (SCOTT.EMP E JOIN SCOTT.EMP m
ON E.MGR=M.EMPNO)JOIN SCOTT.EMP MM
ON M.MGR=MM.EMPNO;

SELECT * FROM SCOTT.EMP;








